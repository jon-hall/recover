#!/usr/bin/env node
'use strict';

const argv = require('commander')
    .version(require('../package.json').version)
    .usage('recover <to|push|pop|reset>')
    .option('-t, --target [path]', 'Specify the folder to use recover on')
    .option('-g, --gitdir [path]', 'Specify the path for the git directory recover will use')
    .parse(process.argv),
    recover = require('../src/recover')(argv),
    args = argv.args;

let cmd,
    op = args[0];

switch(op) {
    case 'to':
        cmd = recover.to(args[1]);
        break;
    case 'push':
        cmd = recover.push(args[1]);
        break;
    case 'pop':
        cmd = recover.pop();
        break;
    case 'reset':
        cmd = recover.reset();
        break;
    default:
        op = 'to';
        cmd = recover.to(args[0]);
        break;
}

cmd.then(
    _ => console.log('"%s" command executed successfully', op),
    err => console.error(err)
);
